/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Inject, Injectable } from '@angular/core';
import * as i18n from 'i18next';
import { I18NEXT_ERROR_HANDLING_STRATEGY } from './I18NEXT_TOKENS';
import { I18NextEvents } from './I18NextEvents';
/** @type {?} */
var i18next = i18n.default;
var I18NextService = /** @class */ (function () {
    function I18NextService(errorHandlingStrategy) {
        this.errorHandlingStrategy = errorHandlingStrategy;
        this.events = new I18NextEvents();
        this.language = '';
        this.languages = [];
    }
    Object.defineProperty(I18NextService.prototype, "options", {
        get: /**
         * @return {?}
         */
        function () {
            return i18next.options;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} plugin
     * @return {THIS}
     */
    I18NextService.prototype.use = /**
     * @template THIS
     * @this {THIS}
     * @param {?} plugin
     * @return {THIS}
     */
    function (plugin) {
        i18next.use.call(i18next, plugin);
        return (/** @type {?} */ (this));
    };
    /**
     * @param {?=} options
     * @return {?}
     */
    I18NextService.prototype.init = /**
     * @param {?=} options
     * @return {?}
     */
    function (options) {
        var _this = this;
        options = options || {};
        this.subscribeEvents();
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        function (resolve, reject) {
            i18next.init.call(i18next, Object.assign({}, options), _this.errorHandlingStrategy.handle(resolve, reject));
        }));
    };
    /**
     * @param {?} key
     * @param {?=} options
     * @return {?}
     */
    I18NextService.prototype.t = /**
     * @param {?} key
     * @param {?=} options
     * @return {?}
     */
    function (key, options) {
        options = options || {};
        return i18next.t.call(i18next, (/** @type {?} */ (key)), options);
    };
    /**
     * @param {?} value
     * @param {?} format
     * @param {?} lng
     * @return {?}
     */
    I18NextService.prototype.format = /**
     * @param {?} value
     * @param {?} format
     * @param {?} lng
     * @return {?}
     */
    function (value, format, lng) {
        return i18next.format.call(i18next, value, format, lng);
    };
    /**
     * @param {?} key
     * @param {?} options
     * @return {?}
     */
    I18NextService.prototype.exists = /**
     * @param {?} key
     * @param {?} options
     * @return {?}
     */
    function (key, options) {
        return i18next.exists.call(i18next, key, options);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    I18NextService.prototype.getFixedT = /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    function (lng, ns) {
        return i18next.getFixedT.call(i18next, lng, ns);
    };
    /**
     * @param {?} ns
     * @return {?}
     */
    I18NextService.prototype.setDefaultNamespace = /**
     * @param {?} ns
     * @return {?}
     */
    function (ns) {
        i18next.setDefaultNamespace.call(i18next, ns);
    };
    /**
     * @param {?=} lng
     * @return {?}
     */
    I18NextService.prototype.dir = /**
     * @param {?=} lng
     * @return {?}
     */
    function (lng) {
        if (lng === void 0) { lng = undefined; }
        return i18next.dir.call(i18next, lng);
    };
    /**
     * @param {?} lng
     * @return {?}
     */
    I18NextService.prototype.changeLanguage = /**
     * @param {?} lng
     * @return {?}
     */
    function (lng) {
        var _this = this;
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        function (resolve, reject) {
            i18next.changeLanguage.call(i18next, lng, _this.errorHandlingStrategy.handle(resolve, reject));
        }));
    };
    /**
     * @param {?} namespaces
     * @return {?}
     */
    I18NextService.prototype.loadNamespaces = /**
     * @param {?} namespaces
     * @return {?}
     */
    function (namespaces) {
        var _this = this;
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        function (resolve, reject) {
            i18next.loadNamespaces.call(i18next, namespaces, _this.errorHandlingStrategy.handle(resolve, reject));
        }));
    };
    /**
     * @param {?} lngs
     * @param {?} callback
     * @return {?}
     */
    I18NextService.prototype.loadLanguages = /**
     * @param {?} lngs
     * @param {?} callback
     * @return {?}
     */
    function (lngs, callback) {
        var _this = this;
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        function (resolve, reject) {
            i18next.loadNamespaces.call(i18next, lngs, _this.errorHandlingStrategy.handle(resolve, reject));
        }));
    };
    //#region resource handling
    //#region resource handling
    /**
     * @param {...?} params
     * @return {?}
     */
    I18NextService.prototype.reloadResources = 
    //#region resource handling
    /**
     * @param {...?} params
     * @return {?}
     */
    function () {
        var params = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            params[_i] = arguments[_i];
        }
        i18next.reloadResources.apply(i18next, params);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} key
     * @param {?} options
     * @return {?}
     */
    I18NextService.prototype.getResource = /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} key
     * @param {?} options
     * @return {?}
     */
    function (lng, ns, key, options) {
        return i18next.getResource.call(i18next, lng, ns, key, options);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} key
     * @param {?} value
     * @param {?} options
     * @return {?}
     */
    I18NextService.prototype.addResource = /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} key
     * @param {?} value
     * @param {?} options
     * @return {?}
     */
    function (lng, ns, key, value, options) {
        i18next.addResource.call(i18next, lng, ns, key, value, options);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} resources
     * @return {?}
     */
    I18NextService.prototype.addResources = /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} resources
     * @return {?}
     */
    function (lng, ns, resources) {
        i18next.addResources.call(i18next, lng, ns, resources);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} resources
     * @param {?} deep
     * @param {?} overwrite
     * @return {?}
     */
    I18NextService.prototype.addResourceBundle = /**
     * @param {?} lng
     * @param {?} ns
     * @param {?} resources
     * @param {?} deep
     * @param {?} overwrite
     * @return {?}
     */
    function (lng, ns, resources, deep, overwrite) {
        i18next.addResourceBundle.call(i18next, lng, ns, resources, deep, overwrite);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    I18NextService.prototype.hasResourceBundle = /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    function (lng, ns) {
        return i18next.hasResourceBundle.call(i18next, lng, ns);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    I18NextService.prototype.getResourceBundle = /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    function (lng, ns) {
        return i18next.getResourceBundle.call(i18next, lng, ns);
    };
    /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    I18NextService.prototype.removeResourceBundle = /**
     * @param {?} lng
     * @param {?} ns
     * @return {?}
     */
    function (lng, ns) {
        i18next.removeResourceBundle.call(i18next, lng, ns);
    };
    //#endregion
    //#endregion
    /**
     * @private
     * @return {?}
     */
    I18NextService.prototype.subscribeEvents = 
    //#endregion
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        i18next.on.call(i18next, 'initialized', (/**
         * @param {?} options
         * @return {?}
         */
        function (options) {
            _this.language = i18next.language;
            _this.languages = i18next.languages;
            _this.events.initialized.next(options);
        }));
        i18next.on.call(i18next, 'loaded', (/**
         * @param {?} loaded
         * @return {?}
         */
        function (loaded) { return _this.events.loaded.next(loaded); }));
        i18next.on.call(i18next, 'failedLoading', (/**
         * @param {?} lng
         * @param {?} ns
         * @param {?} msg
         * @return {?}
         */
        function (lng, ns, msg) { return _this.events.failedLoading.next({ lng: lng, ns: ns, msg: msg }); }));
        i18next.on.call(i18next, 'languageChanged', (/**
         * @param {?} lng
         * @return {?}
         */
        function (lng) {
            _this.language = i18next.language;
            _this.languages = i18next.languages;
            _this.events.languageChanged.next(lng);
        }));
        i18next.on.call(i18next, 'missingKey', (/**
         * @param {?} lngs
         * @param {?} namespace
         * @param {?} key
         * @param {?} res
         * @return {?}
         */
        function (lngs, namespace, key, res) { return _this.events.missingKey.next({ lngs: lngs, namespace: namespace, key: key, res: res }); }));
        i18next.on.call(i18next, 'added', (/**
         * @param {?} lng
         * @param {?} ns
         * @return {?}
         */
        function (lng, ns) { return _this.events.added.next({ lng: lng, ns: ns }); }));
        i18next.on.call(i18next, 'removed', (/**
         * @param {?} lng
         * @param {?} ns
         * @return {?}
         */
        function (lng, ns) { return _this.events.removed.next({ lng: lng, ns: ns }); }));
    };
    I18NextService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    I18NextService.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [I18NEXT_ERROR_HANDLING_STRATEGY,] }] }
    ]; };
    return I18NextService;
}());
export { I18NextService };
if (false) {
    /** @type {?} */
    I18NextService.prototype.events;
    /** @type {?} */
    I18NextService.prototype.language;
    /** @type {?} */
    I18NextService.prototype.languages;
    /**
     * @type {?}
     * @private
     */
    I18NextService.prototype.errorHandlingStrategy;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSTE4TmV4dFNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbmd1bGFyLWkxOG5leHQvIiwic291cmNlcyI6WyJJMThOZXh0U2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbkQsT0FBTyxLQUFLLElBQUksTUFBTSxTQUFTLENBQUM7QUFFaEMsT0FBTyxFQUFFLCtCQUErQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFbkUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDOztJQU0xQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU87QUFFNUI7SUFXRSx3QkFBNkQscUJBQW1EO1FBQW5ELDBCQUFxQixHQUFyQixxQkFBcUIsQ0FBOEI7UUFSaEgsV0FBTSxHQUF1QixJQUFJLGFBQWEsRUFBRSxDQUFDO1FBQ2pELGFBQVEsR0FBVyxFQUFFLENBQUM7UUFDdEIsY0FBUyxHQUFhLEVBQUUsQ0FBQztJQU0wRixDQUFDO0lBSnBILHNCQUFJLG1DQUFPOzs7O1FBQVg7WUFDRSxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDekIsQ0FBQzs7O09BQUE7Ozs7Ozs7SUFJTSw0QkFBRzs7Ozs7O0lBQVYsVUFBVyxNQUFXO1FBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNsQyxPQUFPLG1CQUFBLElBQUksRUFBQSxDQUFDO0lBQ2QsQ0FBQzs7Ozs7SUFFTSw2QkFBSTs7OztJQUFYLFVBQVksT0FBYTtRQUF6QixpQkFjQztRQWJDLE9BQU8sR0FBRyxPQUFPLElBQUksRUFBRSxDQUFDO1FBRXhCLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUV2QixPQUFPLElBQUksT0FBTzs7Ozs7UUFDZCxVQUNFLE9BQXVELEVBQ3ZELE1BQTRCO1lBRTVCLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsRUFBRSxLQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQzdHLENBQUMsRUFDRixDQUFDO0lBRU4sQ0FBQzs7Ozs7O0lBRU0sMEJBQUM7Ozs7O0lBQVIsVUFBUyxHQUFzQixFQUFFLE9BQWE7UUFDNUMsT0FBTyxHQUFHLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDeEIsT0FBTyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsbUJBQUssR0FBRyxFQUFBLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDcEQsQ0FBQzs7Ozs7OztJQUVNLCtCQUFNOzs7Ozs7SUFBYixVQUFjLEtBQVUsRUFBRSxNQUFjLEVBQUUsR0FBVztRQUNuRCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzFELENBQUM7Ozs7OztJQUVNLCtCQUFNOzs7OztJQUFiLFVBQWMsR0FBRyxFQUFFLE9BQU87UUFDeEIsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3BELENBQUM7Ozs7OztJQUVNLGtDQUFTOzs7OztJQUFoQixVQUFpQixHQUFHLEVBQUUsRUFBRTtRQUN0QixPQUFPLE9BQU8sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDbEQsQ0FBQzs7Ozs7SUFFTSw0Q0FBbUI7Ozs7SUFBMUIsVUFBMkIsRUFBVTtRQUNuQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNoRCxDQUFDOzs7OztJQUVNLDRCQUFHOzs7O0lBQVYsVUFBVyxHQUF1QjtRQUF2QixvQkFBQSxFQUFBLGVBQXVCO1FBQzlCLE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzFDLENBQUM7Ozs7O0lBRU0sdUNBQWM7Ozs7SUFBckIsVUFBc0IsR0FBVztRQUFqQyxpQkFTQztRQVJDLE9BQU8sSUFBSSxPQUFPOzs7OztRQUNoQixVQUNFLE9BQXVELEVBQ3ZELE1BQTRCO1lBRTFCLE9BQU8sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsS0FBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNsRyxDQUFDLEVBQ0YsQ0FBQztJQUNKLENBQUM7Ozs7O0lBRU0sdUNBQWM7Ozs7SUFBckIsVUFBc0IsVUFBNkI7UUFBbkQsaUJBU0M7UUFSQyxPQUFPLElBQUksT0FBTzs7Ozs7UUFDaEIsVUFDRSxPQUF1RCxFQUN2RCxNQUE0QjtZQUUxQixPQUFPLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUksQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDekcsQ0FBQyxFQUNGLENBQUM7SUFDSixDQUFDOzs7Ozs7SUFFTSxzQ0FBYTs7Ozs7SUFBcEIsVUFBcUIsSUFBdUIsRUFBRSxRQUFrQjtRQUFoRSxpQkFTQztRQVJDLE9BQU8sSUFBSSxPQUFPOzs7OztRQUNoQixVQUNFLE9BQXVELEVBQ3ZELE1BQTRCO1lBRTFCLE9BQU8sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNuRyxDQUFDLEVBQ0YsQ0FBQztJQUNKLENBQUM7SUFFRCwyQkFBMkI7Ozs7OztJQUVwQix3Q0FBZTs7Ozs7O0lBQXRCO1FBQXVCLGdCQUFTO2FBQVQsVUFBUyxFQUFULHFCQUFTLEVBQVQsSUFBUztZQUFULDJCQUFTOztRQUM5QixPQUFPLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDakQsQ0FBQzs7Ozs7Ozs7SUFFTSxvQ0FBVzs7Ozs7OztJQUFsQixVQUFtQixHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxPQUFPO1FBQ3BDLE9BQU8sT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3BFLENBQUM7Ozs7Ozs7OztJQUVNLG9DQUFXOzs7Ozs7OztJQUFsQixVQUFtQixHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsT0FBTztRQUMzQyxPQUFPLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3BFLENBQUM7Ozs7Ozs7SUFFTSxxQ0FBWTs7Ozs7O0lBQW5CLFVBQW9CLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUztRQUNsQyxPQUFPLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUMzRCxDQUFDOzs7Ozs7Ozs7SUFFTSwwQ0FBaUI7Ozs7Ozs7O0lBQXhCLFVBQXlCLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTO1FBQ3hELE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNqRixDQUFDOzs7Ozs7SUFFTSwwQ0FBaUI7Ozs7O0lBQXhCLFVBQXlCLEdBQUcsRUFBRSxFQUFFO1FBQzVCLE9BQU8sT0FBTyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzVELENBQUM7Ozs7OztJQUVNLDBDQUFpQjs7Ozs7SUFBeEIsVUFBeUIsR0FBRyxFQUFFLEVBQUU7UUFDNUIsT0FBTyxPQUFPLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDNUQsQ0FBQzs7Ozs7O0lBRU0sNkNBQW9COzs7OztJQUEzQixVQUE0QixHQUFHLEVBQUUsRUFBRTtRQUMvQixPQUFPLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUVELFlBQVk7Ozs7OztJQUVKLHdDQUFlOzs7Ozs7SUFBdkI7UUFBQSxpQkFpQkM7UUFoQkMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGFBQWE7Ozs7UUFBRSxVQUFBLE9BQU87WUFDN0MsS0FBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDO1lBQ2pDLEtBQUksQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQztZQUNuQyxLQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDeEMsQ0FBQyxFQUFDLENBQUM7UUFDSCxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsUUFBUTs7OztRQUFFLFVBQUEsTUFBTSxJQUFJLE9BQUEsS0FBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUEvQixDQUErQixFQUFDLENBQUM7UUFDOUUsT0FBTyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGVBQWU7Ozs7OztRQUFFLFVBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLElBQUssT0FBQSxLQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsRUFBQyxHQUFHLEtBQUEsRUFBRSxFQUFFLElBQUEsRUFBRSxHQUFHLEtBQUEsRUFBQyxDQUFDLEVBQTlDLENBQThDLEVBQUMsQ0FBQztRQUM1RyxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsaUJBQWlCOzs7O1FBQUUsVUFBQSxHQUFHO1lBQzdDLEtBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztZQUNqQyxLQUFJLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUM7WUFDbkMsS0FBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3hDLENBQUMsRUFBQyxDQUFDO1FBQ0gsT0FBTyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFlBQVk7Ozs7Ozs7UUFBRSxVQUFDLElBQUksRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSyxPQUFBLEtBQUksQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksTUFBQSxFQUFFLFNBQVMsV0FBQSxFQUFFLEdBQUcsS0FBQSxFQUFFLEdBQUcsS0FBQSxFQUFDLENBQUMsRUFBeEQsQ0FBd0QsRUFBQyxDQUFDO1FBQ2hJLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPOzs7OztRQUFFLFVBQUMsR0FBRyxFQUFFLEVBQUUsSUFBSyxPQUFBLEtBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFDLEdBQUcsS0FBQSxFQUFFLEVBQUUsSUFBQSxFQUFDLENBQUMsRUFBakMsQ0FBaUMsRUFBQyxDQUFDO1FBQ2xGLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxTQUFTOzs7OztRQUFFLFVBQUMsR0FBRyxFQUFFLEVBQUUsSUFBSyxPQUFBLEtBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFDLEdBQUcsS0FBQSxFQUFFLEVBQUUsSUFBQSxFQUFDLENBQUMsRUFBbkMsQ0FBbUMsRUFBQyxDQUFDO0lBRXhGLENBQUM7O2dCQWpKRixVQUFVOzs7O2dEQVdJLE1BQU0sU0FBQywrQkFBK0I7O0lBdUlyRCxxQkFBQztDQUFBLEFBbEpELElBa0pDO1NBakpZLGNBQWM7OztJQUV6QixnQ0FBaUQ7O0lBQ2pELGtDQUFzQjs7SUFDdEIsbUNBQXlCOzs7OztJQU1iLCtDQUFvRyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdCwgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgKiBhcyBpMThuIGZyb20gJ2kxOG5leHQnO1xyXG5cclxuaW1wb3J0IHsgSTE4TkVYVF9FUlJPUl9IQU5ETElOR19TVFJBVEVHWSB9IGZyb20gJy4vSTE4TkVYVF9UT0tFTlMnO1xyXG5pbXBvcnQgeyBJMThOZXh0RXJyb3JIYW5kbGluZ1N0cmF0ZWd5IH0gZnJvbSAnLi9JMThOZXh0RXJyb3JIYW5kbGluZ1N0cmF0ZWdpZXMnO1xyXG5pbXBvcnQgeyBJMThOZXh0RXZlbnRzIH0gZnJvbSAnLi9JMThOZXh0RXZlbnRzJztcclxuaW1wb3J0IHsgSTE4TmV4dExvYWRSZXN1bHQgfSBmcm9tICcuL0kxOE5leHRMb2FkUmVzdWx0JztcclxuaW1wb3J0IHsgSVRyYW5zbGF0aW9uRXZlbnRzIH0gZnJvbSAnLi9JVHJhbnNsYXRpb25FdmVudHMnO1xyXG5pbXBvcnQgeyBJVHJhbnNsYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi9JVHJhbnNsYXRpb25TZXJ2aWNlJztcclxuXHJcblxyXG5jb25zdCBpMThuZXh0ID0gaTE4bi5kZWZhdWx0O1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgSTE4TmV4dFNlcnZpY2UgaW1wbGVtZW50cyBJVHJhbnNsYXRpb25TZXJ2aWNlIHtcclxuXHJcbiAgZXZlbnRzOiBJVHJhbnNsYXRpb25FdmVudHMgPSBuZXcgSTE4TmV4dEV2ZW50cygpO1xyXG4gIGxhbmd1YWdlOiBzdHJpbmcgPSAnJztcclxuICBsYW5ndWFnZXM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gIGdldCBvcHRpb25zKCk6IGFueSB7XHJcbiAgICByZXR1cm4gaTE4bmV4dC5vcHRpb25zO1xyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IoQEluamVjdChJMThORVhUX0VSUk9SX0hBTkRMSU5HX1NUUkFURUdZKSBwcml2YXRlIGVycm9ySGFuZGxpbmdTdHJhdGVneTogSTE4TmV4dEVycm9ySGFuZGxpbmdTdHJhdGVneSkge31cclxuXHJcbiAgcHVibGljIHVzZShwbHVnaW46IGFueSkge1xyXG4gICAgaTE4bmV4dC51c2UuY2FsbChpMThuZXh0LCBwbHVnaW4pO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaW5pdChvcHRpb25zPzogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG5cclxuICAgIHRoaXMuc3Vic2NyaWJlRXZlbnRzKCk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPEkxOE5leHRMb2FkUmVzdWx0PihcclxuICAgICAgICAoXHJcbiAgICAgICAgICByZXNvbHZlOiAodGhlbmFibGVPclJlc3VsdD86IEkxOE5leHRMb2FkUmVzdWx0KSA9PiB2b2lkLFxyXG4gICAgICAgICAgcmVqZWN0OiAoZXJyb3I6IGFueSkgPT4gdm9pZFxyXG4gICAgICAgICkgPT4ge1xyXG4gICAgICAgICAgaTE4bmV4dC5pbml0LmNhbGwoaTE4bmV4dCwgT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyksIHRoaXMuZXJyb3JIYW5kbGluZ1N0cmF0ZWd5LmhhbmRsZShyZXNvbHZlLCByZWplY3QpKTtcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIHQoa2V5OiBzdHJpbmcgfCBzdHJpbmdbXSwgb3B0aW9ucz86IGFueSk6IHN0cmluZyB7XHJcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgIHJldHVybiBpMThuZXh0LnQuY2FsbChpMThuZXh0LCA8YW55PmtleSwgb3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZm9ybWF0KHZhbHVlOiBhbnksIGZvcm1hdDogc3RyaW5nLCBsbmc6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gaTE4bmV4dC5mb3JtYXQuY2FsbChpMThuZXh0LCB2YWx1ZSwgZm9ybWF0LCBsbmcpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGV4aXN0cyhrZXksIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBpMThuZXh0LmV4aXN0cy5jYWxsKGkxOG5leHQsIGtleSwgb3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0Rml4ZWRUKGxuZywgbnMpIHtcclxuICAgIHJldHVybiBpMThuZXh0LmdldEZpeGVkVC5jYWxsKGkxOG5leHQsIGxuZywgbnMpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldERlZmF1bHROYW1lc3BhY2UobnM6IHN0cmluZykge1xyXG4gICAgaTE4bmV4dC5zZXREZWZhdWx0TmFtZXNwYWNlLmNhbGwoaTE4bmV4dCwgbnMpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGRpcihsbmc6IHN0cmluZyA9IHVuZGVmaW5lZCkge1xyXG4gICAgICByZXR1cm4gaTE4bmV4dC5kaXIuY2FsbChpMThuZXh0LCBsbmcpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNoYW5nZUxhbmd1YWdlKGxuZzogc3RyaW5nKTogUHJvbWlzZTxJMThOZXh0TG9hZFJlc3VsdD4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPEkxOE5leHRMb2FkUmVzdWx0PihcclxuICAgICAgKFxyXG4gICAgICAgIHJlc29sdmU6ICh0aGVuYWJsZU9yUmVzdWx0PzogSTE4TmV4dExvYWRSZXN1bHQpID0+IHZvaWQsXHJcbiAgICAgICAgcmVqZWN0OiAoZXJyb3I6IGFueSkgPT4gdm9pZFxyXG4gICAgICApID0+IHtcclxuICAgICAgICAgIGkxOG5leHQuY2hhbmdlTGFuZ3VhZ2UuY2FsbChpMThuZXh0LCBsbmcsIHRoaXMuZXJyb3JIYW5kbGluZ1N0cmF0ZWd5LmhhbmRsZShyZXNvbHZlLCByZWplY3QpKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBsb2FkTmFtZXNwYWNlcyhuYW1lc3BhY2VzOiBzdHJpbmcgfCBzdHJpbmdbXSk6IFByb21pc2U8YW55PiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8STE4TmV4dExvYWRSZXN1bHQ+KFxyXG4gICAgICAoXHJcbiAgICAgICAgcmVzb2x2ZTogKHRoZW5hYmxlT3JSZXN1bHQ/OiBJMThOZXh0TG9hZFJlc3VsdCkgPT4gdm9pZCxcclxuICAgICAgICByZWplY3Q6IChlcnJvcjogYW55KSA9PiB2b2lkXHJcbiAgICAgICkgPT4ge1xyXG4gICAgICAgICAgaTE4bmV4dC5sb2FkTmFtZXNwYWNlcy5jYWxsKGkxOG5leHQsIG5hbWVzcGFjZXMsIHRoaXMuZXJyb3JIYW5kbGluZ1N0cmF0ZWd5LmhhbmRsZShyZXNvbHZlLCByZWplY3QpKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBsb2FkTGFuZ3VhZ2VzKGxuZ3M6IHN0cmluZyB8IHN0cmluZ1tdLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTxJMThOZXh0TG9hZFJlc3VsdD4oXHJcbiAgICAgIChcclxuICAgICAgICByZXNvbHZlOiAodGhlbmFibGVPclJlc3VsdD86IEkxOE5leHRMb2FkUmVzdWx0KSA9PiB2b2lkLFxyXG4gICAgICAgIHJlamVjdDogKGVycm9yOiBhbnkpID0+IHZvaWRcclxuICAgICAgKSA9PiB7XHJcbiAgICAgICAgICBpMThuZXh0LmxvYWROYW1lc3BhY2VzLmNhbGwoaTE4bmV4dCwgbG5ncywgdGhpcy5lcnJvckhhbmRsaW5nU3RyYXRlZ3kuaGFuZGxlKHJlc29sdmUsIHJlamVjdCkpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8jcmVnaW9uIHJlc291cmNlIGhhbmRsaW5nXHJcblxyXG4gIHB1YmxpYyByZWxvYWRSZXNvdXJjZXMoLi4ucGFyYW1zKSB7XHJcbiAgICBpMThuZXh0LnJlbG9hZFJlc291cmNlcy5hcHBseShpMThuZXh0LCBwYXJhbXMpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFJlc291cmNlKGxuZywgbnMsIGtleSwgb3B0aW9ucykge1xyXG4gICAgICByZXR1cm4gaTE4bmV4dC5nZXRSZXNvdXJjZS5jYWxsKGkxOG5leHQsIGxuZywgbnMsIGtleSwgb3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYWRkUmVzb3VyY2UobG5nLCBucywga2V5LCB2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgICBpMThuZXh0LmFkZFJlc291cmNlLmNhbGwoaTE4bmV4dCwgbG5nLCBucywga2V5LCB2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYWRkUmVzb3VyY2VzKGxuZywgbnMsIHJlc291cmNlcykge1xyXG4gICAgICBpMThuZXh0LmFkZFJlc291cmNlcy5jYWxsKGkxOG5leHQsIGxuZywgbnMsIHJlc291cmNlcyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYWRkUmVzb3VyY2VCdW5kbGUobG5nLCBucywgcmVzb3VyY2VzLCBkZWVwLCBvdmVyd3JpdGUpIHtcclxuICAgICAgaTE4bmV4dC5hZGRSZXNvdXJjZUJ1bmRsZS5jYWxsKGkxOG5leHQsIGxuZywgbnMsIHJlc291cmNlcywgZGVlcCwgb3ZlcndyaXRlKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBoYXNSZXNvdXJjZUJ1bmRsZShsbmcsIG5zKSB7XHJcbiAgICAgIHJldHVybiBpMThuZXh0Lmhhc1Jlc291cmNlQnVuZGxlLmNhbGwoaTE4bmV4dCwgbG5nLCBucyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0UmVzb3VyY2VCdW5kbGUobG5nLCBucykge1xyXG4gICAgICByZXR1cm4gaTE4bmV4dC5nZXRSZXNvdXJjZUJ1bmRsZS5jYWxsKGkxOG5leHQsIGxuZywgbnMpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlbW92ZVJlc291cmNlQnVuZGxlKGxuZywgbnMpIHtcclxuICAgICAgaTE4bmV4dC5yZW1vdmVSZXNvdXJjZUJ1bmRsZS5jYWxsKGkxOG5leHQsIGxuZywgbnMpO1xyXG4gIH1cclxuXHJcbiAgLy8jZW5kcmVnaW9uXHJcblxyXG4gIHByaXZhdGUgc3Vic2NyaWJlRXZlbnRzKCkge1xyXG4gICAgaTE4bmV4dC5vbi5jYWxsKGkxOG5leHQsICdpbml0aWFsaXplZCcsIG9wdGlvbnMgPT4ge1xyXG4gICAgICB0aGlzLmxhbmd1YWdlID0gaTE4bmV4dC5sYW5ndWFnZTtcclxuICAgICAgdGhpcy5sYW5ndWFnZXMgPSBpMThuZXh0Lmxhbmd1YWdlcztcclxuICAgICAgdGhpcy5ldmVudHMuaW5pdGlhbGl6ZWQubmV4dChvcHRpb25zKTtcclxuICAgIH0pO1xyXG4gICAgaTE4bmV4dC5vbi5jYWxsKGkxOG5leHQsICdsb2FkZWQnLCBsb2FkZWQgPT4gdGhpcy5ldmVudHMubG9hZGVkLm5leHQobG9hZGVkKSk7XHJcbiAgICBpMThuZXh0Lm9uLmNhbGwoaTE4bmV4dCwgJ2ZhaWxlZExvYWRpbmcnLCAobG5nLCBucywgbXNnKSA9PiB0aGlzLmV2ZW50cy5mYWlsZWRMb2FkaW5nLm5leHQoe2xuZywgbnMsIG1zZ30pKTtcclxuICAgIGkxOG5leHQub24uY2FsbChpMThuZXh0LCAnbGFuZ3VhZ2VDaGFuZ2VkJywgbG5nID0+IHtcclxuICAgICAgdGhpcy5sYW5ndWFnZSA9IGkxOG5leHQubGFuZ3VhZ2U7XHJcbiAgICAgIHRoaXMubGFuZ3VhZ2VzID0gaTE4bmV4dC5sYW5ndWFnZXM7XHJcbiAgICAgIHRoaXMuZXZlbnRzLmxhbmd1YWdlQ2hhbmdlZC5uZXh0KGxuZyk7XHJcbiAgICB9KTtcclxuICAgIGkxOG5leHQub24uY2FsbChpMThuZXh0LCAnbWlzc2luZ0tleScsIChsbmdzLCBuYW1lc3BhY2UsIGtleSwgcmVzKSA9PiB0aGlzLmV2ZW50cy5taXNzaW5nS2V5Lm5leHQoe2xuZ3MsIG5hbWVzcGFjZSwga2V5LCByZXN9KSk7XHJcbiAgICBpMThuZXh0Lm9uLmNhbGwoaTE4bmV4dCwgJ2FkZGVkJywgKGxuZywgbnMpID0+IHRoaXMuZXZlbnRzLmFkZGVkLm5leHQoe2xuZywgbnN9KSk7XHJcbiAgICBpMThuZXh0Lm9uLmNhbGwoaTE4bmV4dCwgJ3JlbW92ZWQnLCAobG5nLCBucykgPT4gdGhpcy5ldmVudHMucmVtb3ZlZC5uZXh0KHtsbmcsIG5zfSkpO1xyXG5cclxuICB9XHJcbn1cclxuIl19